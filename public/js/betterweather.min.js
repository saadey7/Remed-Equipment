/**
 * BetterWeather v1.3
 * Author: BetterStudio (http://themeforest.net/user/Better-Studio)
 * @license BetterStudio
*/
!function(e){e.betterWeather=function(t,a){var n=this;n.$el=e(t),n.el=t,n.$el.data("betterWeather",n),n.tries=1,n.templateInitialized=!1,n.retina=window.devicePixelRatio>1,n.defaultOptions={source:"forecast",apiKey:"",location:"",locationName:"",showLocation:!0,showDate:!0,visitorLocation:!1,fontColor:"#fff",bgColor:"#4f4f4f",style:"normal",nextDays:!0,animatedIcons:!0,naturalBackground:!0,url:"better-weather/ajax/ajax.php",unit:"C",showUnit:!1,mode:"widget",inlineSize:"medium"},n.elements={location:"",date:"",currentlyDegree:"",upDegree:"",summary:"",summaryIconContainer:"",day1Title:"",day1Degree:"",day1IconContainer:"",day2Title:"",day2Degree:"",day2IconContainer:"",day3Title:"",day3Degree:"",day3IconContainer:"",day4Title:"",day4Degree:"",day4IconContainer:""},n.monthList={January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December"},n.daysList={Sat:"Sat",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri"},n.stateList={clear:"Clear",rain:"Rain",snow:"Snow",sleet:"Sleet",wind:"Wind",foggy:"Foggy",cloudy:"Cloudy",mostly_cloudy:"Mostly Cloudy",partly_cloudy:"Partly Cloudy",thunderstorm:"Thunderstorm",drizzle:"Drizzle",light_Rain:"Light Rain",breezy_and_Partly_Cloudy:"breezy and Partly Cloudy",overcast:"Overcast"},n.data={latitude:"",longitude:"",timezone:"",currently:{time:"",summary:"",icon:"",nearestStormDistance:"",nearestStormBearing:"",precipIntensity:"",precipProbability:"",temperature:"",apparentTemperature:"",dewPoint:"",humidity:"",windSpeed:"",windBearing:"",visibility:"",cloudCover:"",pressure:"",ozone:"",temperatureMin:"",temperatureMax:"",sunriseTime:"",sunsetTime:""},daily:[{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""},{dayName:"",time:"",icon:""}]},n.init=function(){if(n.options=e.extend({},n.defaultOptions,a),n.helper.showLoader(),n.initColor(),n.initStyle(),""===n.options.apiKey){if("undefined"==typeof BW_Localized||null===BW_Localized||"undefined"==typeof BW_Localized.apiKey||null===BW_Localized.apiKey)return n.helper.hideLoader(),void n.helper.log("error","No API Key provided! "," Obtain API Key from https://developers.forecast.io");n.options.apiKey=BW_Localized.apiKey}n.getDataAjax()},n.initTemplate=function(){n.helper.cleanLog(),n.templateInitialized!==!0&&(n.templateInitialized=!0,"widget"===n.options.mode?(n.options.naturalBackground&&n.$el.addClass("with-natural-background"),n.options.showUnit&&n.$el.addClass("unit-showed"),n.$el.append(n.helper.templateWidgetCurrently),n.options.showLocation?n.elements.location=n.$el.find(".bw_currently .bw_location"):(n.$el.find(".bw_currently .bw_location").remove(),n.$el.find(".bw_currently .bw_separator").remove()),n.options.showDate?n.elements.date=n.$el.find(".bw_currently .bw_date"):(n.$el.find(".bw_currently .bw_date").remove(),n.$el.find(".bw_currently .bw_separator").remove()),n.elements.currentlyDegree=n.$el.find(".bw_currently .bw_degree"),n.elements.upDegree=n.$el.find(".bw_currently .bw_up-degree"),n.elements.downDegree=n.$el.find(".bw_currently .bw_down-degree"),n.elements.summaryIconContainer=n.$el.find(".bw_currently .bw_summary .bw_icon-container"),n.elements.summary=n.$el.find(".bw_currently .bw_summary p"),n.options.nextDays&&(n.$el.addClass("have-next-days"),n.$el.append(n.helper.templateWidgetNextDays),n.elements.day1Title=n.$el.find(".bw_days .bw_day-1 .bw_day-title"),n.elements.day1IconContainer=n.$el.find(".bw_days .bw_day-1 .bw_icon-container"),n.elements.day2Title=n.$el.find(".bw_days .bw_day-2 .bw_day-title"),n.elements.day2IconContainer=n.$el.find(".bw_days .bw_day-2 .bw_icon-container"),n.elements.day3Title=n.$el.find(".bw_days .bw_day-3 .bw_day-title"),n.elements.day3IconContainer=n.$el.find(".bw_days .bw_day-3 .bw_icon-container"),n.elements.day4Title=n.$el.find(".bw_days .bw_day-4 .bw_day-title"),n.elements.day4IconContainer=n.$el.find(".bw_days .bw_day-4 .bw_icon-container")),n.initIcons(),n.prettifyIconSize(),e(window).resize(function(){n.prettifyIconSize()})):"inline"===n.options.mode&&(n.$el.append(n.helper.templateInlineCurrently),n.elements.summaryIconContainer=n.$el.find(".bw_icon_container"),n.elements.currentlyDegree=n.$el.find(".bw_temperature"),n.elements.summary=n.$el.find(".bw_summary"),n.initIcons()))},n.refreshData=function(){if("widget"===n.options.mode){n.$el.addClass("state-"+n.data.currently.icon);var e=new Date(1e3*n.data.currently.sunriseTime),t=new Date(1e3*n.data.currently.sunsetTime),a=new Date,i=new Date(a.getTime()+-18e5),o=new Date(a.getTime()+18e5);if(e>=i&&o>=e?(n.$el.removeClass("state-"+n.data.currently.icon),n.$el.addClass("state-sunrise")):t>=i&&o>=t&&(n.$el.removeClass("state-"+n.data.currently.icon),n.$el.addClass("state-sunset")),n.helper.setIconTo(n.data.currently.icon,n.elements.summaryIconContainer.find(".bw_icon")),n.elements.summary.text(n.helper.getStateName(n.data.currently.summary)),n.elements.currentlyDegree.find("p").text(n.helper.getPrettyTemperature(n.data.currently.temperature)),n.elements.upDegree.text(n.helper.getPrettyTemperature(n.data.currently.temperatureMax)),n.elements.downDegree.text(n.helper.getPrettyTemperature(n.data.currently.temperatureMin)),n.options.showDate){var r=new Date(1e3*n.data.currently.time);n.elements.date.text(r.getDate()+" "+n.helper.getMonth(r.getMonth()+1))}if(n.options.showLocation)if(""!==n.options.locationName)n.elements.location.text(n.options.locationName);else{var l=n.data.timezone;l=l.split("/"),l=l[l.length-1].replace("_"," "),n.elements.location.text(l)}n.options.nextDays&&(n.helper.setIconTo(n.data.daily[1].icon,n.elements.day1IconContainer.find(".bw_icon")),n.elements.day1Title.text(n.helper.getDayName(n.data.daily[1].dayName)),n.helper.setIconTo(n.data.daily[2].icon,n.elements.day2IconContainer.find(".bw_icon")),n.elements.day2Title.text(n.helper.getDayName(n.data.daily[2].dayName)),n.helper.setIconTo(n.data.daily[3].icon,n.elements.day3IconContainer.find(".bw_icon")),n.elements.day3Title.text(n.helper.getDayName(n.data.daily[3].dayName)),n.helper.setIconTo(n.data.daily[4].icon,n.elements.day4IconContainer.find(".bw_icon")),n.elements.day4Title.text(n.helper.getDayName(n.data.daily[4].dayName)))}else"inline"===n.options.mode&&(n.$el.addClass("state-"+n.data.currently.icon),n.helper.setIconTo(n.data.currently.icon,n.elements.summaryIconContainer.find(".bw_icon")),n.elements.summary.text(n.helper.getStateName(n.data.currently.summary)),n.elements.currentlyDegree.text(n.helper.getPrettyTemperature(n.data.currently.temperature)))},n.emptyData=function(){if("inline "!==n.options.mode){if(n.initTemplate(),n.$el.addClass("state-no-data"),n.elements.summary.text("N/A"),n.elements.currentlyDegree.find("p").text("N/A"),n.elements.upDegree.text("N/A"),n.elements.downDegree.text("N/A"),n.options.showDate){var e=new Date;n.elements.date.text(e.getDate()+" "+n.helper.getMonth(e.getMonth()+1))}n.options.showLocation&&n.elements.location.text(""!==n.options.locationName?n.options.locationName:"N/A"),n.options.nextDays&&(n.elements.day1Title.text("N/A"),n.elements.day2Title.text("N/A"),n.elements.day3Title.text("N/A"),n.elements.day4Title.text("N/A"))}},n.initColor=function(){"widget"===n.options.mode&&(n.options.naturalBackground||n.$el.css("background-color",n.options.bgColor)),n.$el.css("color",n.options.fontColor)},n.initStyle=function(){"widget"===n.options.mode?(n.$el.addClass("style-"+n.options.style),n.$el.addClass("better-weather")):"inline"===n.options.mode&&(n.$el.addClass("bw_size-"+n.options.inlineSize),n.$el.addClass("better-weather-inline"))},n.initIcons=function(){if("widget"===n.options.mode)n.helper.isCanvasSupported()&&(n.skycons=new Skycons({color:n.options.fontColor,dropShadow:!0})),"normal"===n.options.style?n.helper.addCanvasTo(n.elements.summaryIconContainer,n.$el.attr("id")+"-summary-icon",85,85):n.helper.addCanvasTo(n.elements.summaryIconContainer,n.$el.attr("id")+"-summary-icon",55,55),n.options.nextDays&&(n.helper.addCanvasTo(n.elements.day1IconContainer,n.$el.attr("id")+"-day1-icon",17,17),n.helper.addCanvasTo(n.elements.day2IconContainer,n.$el.attr("id")+"-day2-icon",17,17),n.helper.addCanvasTo(n.elements.day3IconContainer,n.$el.attr("id")+"-day3-icon",17,17),n.helper.addCanvasTo(n.elements.day4IconContainer,n.$el.attr("id")+"-day4-icon",17,17));else if("inline"===n.options.mode){n.helper.isCanvasSupported()&&(n.skycons=new Skycons({color:n.options.fontColor,dropShadow:!1}));var e="",t="";switch(n.options.inlineSize){case"small":t=e=18;break;case"medium":t=e=30;break;case"large":t=e=55}n.helper.addCanvasTo(n.elements.summaryIconContainer,n.$el.attr("id")+"-summary-icon",e,t)}},n.prettifyIconSize=function(){var e=n.$el.width(),t=n.elements.summaryIconContainer.find(".bw_icon");if(!t.hasClass("hw_static-icon"))switch(!0){case 70>=e:n.helper.updateIconSize(t,28,28);break;case 100>=e:n.helper.updateIconSize(t,35,35);break;case 200>=e:n.helper.updateIconSize(t,40,40);break;case 400>=e:"modern"===n.options.style?n.helper.updateIconSize(t,55,55):"normal"===n.options.style&&n.helper.updateIconSize(t,70,70);break;case 1170>=e:n.helper.updateIconSize(t,35,35)}},n.getDataAjax=function(){var e="location="+n.options.location;e+="&apikey="+n.options.apiKey,e+="&source="+n.options.source,n.options.visitorLocation&&(e+="&visitor_location=true"),jQuery.ajax({type:"POST",url:n.helper.getAjaxURL(),data:e,dataType:"json",success:function(e){switch(e.status){case"succeed":n.data=e.data,n.initTemplate(),n.helper.hideLoader(),n.refreshData();break;case"error":n.initTemplate(),n.helper.log("error",e.msg,e.data),n.tries<=2?(n.tries++,n.helper.log("alert","Better Weather Another Ajax call sent",""),setTimeout(function(){n.helper.log("alert","Better Weather another Ajax call sent.",""),n.getDataAjax()},3e3)):(n.helper.log("error","Critical problem in Better Weather Ajax calls","Better Weather sent 3 time Ajax Call but retried data has problem! Please check xml.php file and delete cache folder."),setTimeout(function(){n.emptyData(),n.helper.hideLoader()},2e3))}}})},n.helper={getCorretSize:function(e){return n.retina?2*e:e},updateIconSize:function(e,t,a){e.attr("width",n.helper.getCorretSize(t)),e.attr("height",n.helper.getCorretSize(a)),e.css("width",t+"px"),e.css("height",a+"px")},getAjaxURL:function(){return n.options.url!==n.defaultOptions.url?n.options.url:"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.url&&null!==BW_Localized.url?BW_Localized.url:n.defaultOptions.url},showLoader:function(){"inline"!==n.options.mode&&0===n.$el.find(".bw-loader").length&&n.$el.append(n.helper.templateWidgetLoader)},hideLoader:function(){"inline"!==n.options.mode&&n.$el.find(".bw-loader").remove()},celsiusToFahrenheit:function(e){return 9*e/5+32},fahrenheitToCelsius:function(e){return 5*(e-32)/9},getPrettyTemperature:function(e){return"widget"===n.options.mode?"F"===n.options.unit?parseInt(e)+"°"+(n.options.showUnit?"F":""):parseInt(n.helper.fahrenheitToCelsius(e))+"°"+(n.options.showUnit?"C":""):"inline"===n.options.mode?"F"===n.options.unit?parseInt(e)+"°"+(n.options.showUnit?"F":""):parseInt(n.helper.fahrenheitToCelsius(e))+"°"+(n.options.showUnit?"F":""):void 0},getMonth:function(e){var t="";switch(e){case 1:t="January";break;case 2:t="February";break;case 3:t="March";break;case 4:t="April";break;case 5:t="May";break;case 6:t="June";break;case 7:t="July";break;case 8:t="August";break;case 9:t="September";break;case 10:t="October";break;case 11:t="November";break;case 12:t="December"}return"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.monthList&&null!==BW_Localized.monthList&&"undefined"!=typeof BW_Localized.monthList[t]&&null!==BW_Localized.monthList[t]?BW_Localized.monthList[t]:n.monthList[t]},getDayName:function(e){return"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.daysList&&null!==BW_Localized.daysList&&"undefined"!=typeof BW_Localized.daysList[e]&&null!==BW_Localized.daysList[e]?BW_Localized.daysList[e]:n.daysList[e]},getStateName:function(e){var t=e.toLowerCase();return t=t.replace(" ","_"),t=t.replace("-","_"),"undefined"!=typeof BW_Localized&&null!==BW_Localized&&"undefined"!=typeof BW_Localized.stateList&&null!==BW_Localized.stateList&&"undefined"!=typeof BW_Localized.stateList[t]&&null!==BW_Localized.stateList[t]?BW_Localized.stateList[t]:"undefined"!=typeof n.stateList[t]&&null!==n.stateList[t]?n.stateList[t]:e},log:function(e,t,a){switch(e){case"error":"widget"===n.options.mode?(0===n.$el.find(".bw-error").length&&n.$el.append(n.helper.templateWidgetErrors),n.$el.find(".bw-error .bw-error-title").text(t),console.log((""===t?"":t+":")+a)):console.log((""===t?"":t+":")+a);break;case"alert":console.log((""===t?"":t+":")+a)}},cleanLog:function(){n.$el.find(".bw-error").remove()},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},allowedIcons:["clear-day","clear-night","rain","snow","sleet","wind","fog","cloudy","partly-cloudy-day","partly-cloudy-night"],setIconTo:function(t,a){if(n.helper.isCanvasSupported()&&e.inArray(t,n.helper.allowedIcons)>=0&&n.options.animatedIcons===!0)n.skycons.set(a.attr("id"),t),n.skycons.play();else{a.addClass("bw_"+t);var i="";switch(t){case"clear-day":i="wi-day-sunny";break;case"clear-night":i="wi-night-clear";break;case"rain":i="wi-rain";break;case"snow":i="wi-snow";break;case"sleet":i="wi-rain";break;case"wind":i="wi-strong-wind";break;case"thunderstorm":i="wi-lightning";break;case"cloudy":i="wi-cloudy";break;case"partly-cloudy-day":i="wi-day-cloudy";break;case"partly-cloudy-night":i="wi-night-cloudy"}"thunderstorm"===t?(a.parent().append('<i class="'+i+'"></i>'),a.parent().find("canvas").remove()):a.append('<i class="'+i+'"></i>')}},addCanvasTo:function(e,t,a,i){e.append(n.helper.isCanvasSupported()&&n.options.animatedIcons===!0?'<canvas id="'+t+'" class="bw_icon bw_svg-icon" width="'+n.helper.getCorretSize(a)+'" height="'+n.helper.getCorretSize(i)+'" style="height:'+i+"px; width:"+a+'px;"></canvas>':'<span id="'+t+'" class="bw_icon hw_static-icon" ></span>')},templateInlineCurrently:'<span class="bw_icon_container"></span><span class="bw_temperature"></span><span class="bw_summary"></span>',templateWidgetErrors:'<div class="bw-error"><p class="bw-error-sign">&#x26a0;</p><p class="bw-error-title"></p><p class="bw-error-text"></p></div>',templateWidgetLoader:'<div class="bw-loader"></div>',templateWidgetCurrently:'<div class="bw_currently"><div class="bw_date-loc"><span class="bw_location"></span><span class="bw_separator">-</span><span class="bw_date"></span></div><div class="bw_degree-up-down"><span class="bw_up-degree"></span><span class="bw_down-degree"></span></div><div class="bw_summary"><span class="bw_icon-container"></span><p></p></div><div class="bw_degree"><p></p></div></div>',templateWidgetNextDays:'<div class="bw_days"><ul class="bw_days-list"><li class="bw_day-item bw_day-1"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-2"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-3"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li><li class="bw_day-item bw_day-4"><p class="bw_day-title"></p><span class="bw_icon-container"></span></li></ul></div>'},n.init()},e.fn.betterWeather=function(t){return this.each(function(){new e.betterWeather(this,t)})},elementQuery({".better-weather":{"max-width":["2000px","1170px","970px","900px","830px","650px","550px","400px","350px","300px","250px","200px","170px","120px","100px","50px"]}})}(jQuery);